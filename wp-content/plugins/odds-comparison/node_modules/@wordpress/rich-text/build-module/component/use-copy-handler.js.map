{"version":3,"sources":["@wordpress/rich-text/src/component/use-copy-handler.js"],"names":["useRef","useRefEffect","toHTMLString","isCollapsed","slice","getTextContent","useCopyHandler","props","propsRef","current","element","onCopy","event","record","multilineTag","preserveWhiteSpace","ownerDocument","contains","activeElement","selectedRecord","plainText","html","value","clipboardData","setData","preventDefault","type","execCommand","addEventListener","removeEventListener"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,MAAT,QAAuB,oBAAvB;AACA,SAASC,YAAT,QAA6B,oBAA7B;AAEA;AACA;AACA;;AACA,SAASC,YAAT,QAA6B,mBAA7B;AACA,SAASC,WAAT,QAA4B,iBAA5B;AACA,SAASC,KAAT,QAAsB,UAAtB;AACA,SAASC,cAAT,QAA+B,qBAA/B;AAEA,OAAO,SAASC,cAAT,CAAyBC,KAAzB,EAAiC;AACvC,QAAMC,QAAQ,GAAGR,MAAM,CAAEO,KAAF,CAAvB;AACAC,EAAAA,QAAQ,CAACC,OAAT,GAAmBF,KAAnB;AACA,SAAON,YAAY,CAAIS,OAAF,IAAe;AACnC,aAASC,MAAT,CAAiBC,KAAjB,EAAyB;AACxB,YAAM;AAAEC,QAAAA,MAAF;AAAUC,QAAAA,YAAV;AAAwBC,QAAAA;AAAxB,UACLP,QAAQ,CAACC,OADV;AAEA,YAAM;AAAEO,QAAAA;AAAF,UAAoBN,OAA1B;;AACA,UACCP,WAAW,CAAEU,MAAM,CAACJ,OAAT,CAAX,IACA,CAAEC,OAAO,CAACO,QAAR,CAAkBD,aAAa,CAACE,aAAhC,CAFH,EAGE;AACD;AACA;;AAED,YAAMC,cAAc,GAAGf,KAAK,CAAES,MAAM,CAACJ,OAAT,CAA5B;AACA,YAAMW,SAAS,GAAGf,cAAc,CAAEc,cAAF,CAAhC;AACA,YAAME,IAAI,GAAGnB,YAAY,CAAE;AAC1BoB,QAAAA,KAAK,EAAEH,cADmB;AAE1BL,QAAAA,YAF0B;AAG1BC,QAAAA;AAH0B,OAAF,CAAzB;AAKAH,MAAAA,KAAK,CAACW,aAAN,CAAoBC,OAApB,CAA6B,YAA7B,EAA2CJ,SAA3C;AACAR,MAAAA,KAAK,CAACW,aAAN,CAAoBC,OAApB,CAA6B,WAA7B,EAA0CH,IAA1C;AACAT,MAAAA,KAAK,CAACW,aAAN,CAAoBC,OAApB,CAA6B,WAA7B,EAA0C,MAA1C;AACAZ,MAAAA,KAAK,CAACW,aAAN,CAAoBC,OAApB,CACC,0BADD,EAECV,YAAY,IAAI,EAFjB;AAIAF,MAAAA,KAAK,CAACa,cAAN;;AAEA,UAAKb,KAAK,CAACc,IAAN,KAAe,KAApB,EAA4B;AAC3BV,QAAAA,aAAa,CAACW,WAAd,CAA2B,QAA3B;AACA;AACD;;AAEDjB,IAAAA,OAAO,CAACkB,gBAAR,CAA0B,MAA1B,EAAkCjB,MAAlC;AACAD,IAAAA,OAAO,CAACkB,gBAAR,CAA0B,KAA1B,EAAiCjB,MAAjC;AACA,WAAO,MAAM;AACZD,MAAAA,OAAO,CAACmB,mBAAR,CAA6B,MAA7B,EAAqClB,MAArC;AACAD,MAAAA,OAAO,CAACmB,mBAAR,CAA6B,KAA7B,EAAoClB,MAApC;AACA,KAHD;AAIA,GAvCkB,EAuChB,EAvCgB,CAAnB;AAwCA","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useRef } from '@wordpress/element';\nimport { useRefEffect } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport { toHTMLString } from '../to-html-string';\nimport { isCollapsed } from '../is-collapsed';\nimport { slice } from '../slice';\nimport { getTextContent } from '../get-text-content';\n\nexport function useCopyHandler( props ) {\n\tconst propsRef = useRef( props );\n\tpropsRef.current = props;\n\treturn useRefEffect( ( element ) => {\n\t\tfunction onCopy( event ) {\n\t\t\tconst { record, multilineTag, preserveWhiteSpace } =\n\t\t\t\tpropsRef.current;\n\t\t\tconst { ownerDocument } = element;\n\t\t\tif (\n\t\t\t\tisCollapsed( record.current ) ||\n\t\t\t\t! element.contains( ownerDocument.activeElement )\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst selectedRecord = slice( record.current );\n\t\t\tconst plainText = getTextContent( selectedRecord );\n\t\t\tconst html = toHTMLString( {\n\t\t\t\tvalue: selectedRecord,\n\t\t\t\tmultilineTag,\n\t\t\t\tpreserveWhiteSpace,\n\t\t\t} );\n\t\t\tevent.clipboardData.setData( 'text/plain', plainText );\n\t\t\tevent.clipboardData.setData( 'text/html', html );\n\t\t\tevent.clipboardData.setData( 'rich-text', 'true' );\n\t\t\tevent.clipboardData.setData(\n\t\t\t\t'rich-text-multi-line-tag',\n\t\t\t\tmultilineTag || ''\n\t\t\t);\n\t\t\tevent.preventDefault();\n\n\t\t\tif ( event.type === 'cut' ) {\n\t\t\t\townerDocument.execCommand( 'delete' );\n\t\t\t}\n\t\t}\n\n\t\telement.addEventListener( 'copy', onCopy );\n\t\telement.addEventListener( 'cut', onCopy );\n\t\treturn () => {\n\t\t\telement.removeEventListener( 'copy', onCopy );\n\t\t\telement.removeEventListener( 'cut', onCopy );\n\t\t};\n\t}, [] );\n}\n"]}