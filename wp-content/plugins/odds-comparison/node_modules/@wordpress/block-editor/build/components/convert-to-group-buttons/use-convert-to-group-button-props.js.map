{"version":3,"sources":["@wordpress/block-editor/src/components/convert-to-group-buttons/use-convert-to-group-button-props.js"],"names":["useConvertToGroupButtonProps","selectedClientIds","select","getBlockRootClientId","getBlocksByClientId","canInsertBlockType","getSelectedBlockClientIds","blockEditorStore","getGroupingBlockName","getBlockType","blocksStore","clientIds","length","groupingBlockName","rootClientId","undefined","groupingBlockAvailable","blocksSelection","isSingleBlockSelected","firstSelectedBlock","isUngroupable","name","transforms","ungroup","innerBlocks","isGroupable","onUngroup"],"mappings":";;;;;;;AAGA;;AACA;;AAKA;;AATA;AACA;AACA;;AAIA;AACA;AACA;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACe,SAASA,4BAAT,CAAuCC,iBAAvC,EAA2D;AACzE,SAAO,qBACJC,MAAF,IAAc;AACb,UAAM;AACLC,MAAAA,oBADK;AAELC,MAAAA,mBAFK;AAGLC,MAAAA,kBAHK;AAILC,MAAAA;AAJK,QAKFJ,MAAM,CAAEK,YAAF,CALV;AAMA,UAAM;AAAEC,MAAAA,oBAAF;AAAwBC,MAAAA;AAAxB,QACLP,MAAM,CAAEQ,aAAF,CADP;AAEA,UAAMC,SAAS,GAAGV,iBAAiB,EAAEW,MAAnB,GACfX,iBADe,GAEfK,yBAAyB,EAF5B;AAGA,UAAMO,iBAAiB,GAAGL,oBAAoB,EAA9C;AAEA,UAAMM,YAAY,GAAGH,SAAS,EAAEC,MAAX,GAClBT,oBAAoB,CAAEQ,SAAS,CAAE,CAAF,CAAX,CADF,GAElBI,SAFH;AAIA,UAAMC,sBAAsB,GAAGX,kBAAkB,CAChDQ,iBADgD,EAEhDC,YAFgD,CAAjD;AAKA,UAAMG,eAAe,GAAGb,mBAAmB,CAAEO,SAAF,CAA3C;AACA,UAAMO,qBAAqB,GAAGD,eAAe,CAACL,MAAhB,KAA2B,CAAzD;AACA,UAAM,CAAEO,kBAAF,IAAyBF,eAA/B,CAzBa,CA0Bb;AACA;AACA;AACA;;AACA,UAAMG,aAAa,GAClBF,qBAAqB,KACnBC,kBAAkB,CAACE,IAAnB,KAA4BR,iBAA5B,IACDJ,YAAY,CAAEU,kBAAkB,CAACE,IAArB,CAAZ,EAAyCC,UAAzC,EACGC,OAHiB,CAArB,IAIA,CAAC,CAAEJ,kBAAkB,CAACK,WAAnB,CAA+BZ,MALnC,CA9Ba,CAqCb;AACA;AACA;;AACA,UAAMa,WAAW,GAChBT,sBAAsB,IAAIC,eAAe,CAACL,MAD3C;AAGA,WAAO;AACND,MAAAA,SADM;AAENc,MAAAA,WAFM;AAGNL,MAAAA,aAHM;AAINH,MAAAA,eAJM;AAKNJ,MAAAA,iBALM;AAMNa,MAAAA,SAAS,EACRN,aAAa,IACbX,YAAY,CAAEU,kBAAkB,CAACE,IAArB,CAAZ,EAAyCC,UAAzC,EACGC;AATE,KAAP;AAWA,GAvDK,EAwDN,CAAEtB,iBAAF,CAxDM,CAAP;AA0DA","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { store as blocksStore } from '@wordpress/blocks';\nimport { useSelect } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport { store as blockEditorStore } from '../../store';\n\n/**\n * Contains the properties `ConvertToGroupButton` component needs.\n *\n * @typedef {Object} ConvertToGroupButtonProps\n * @property {string[]}  clientIds         An array of the selected client ids.\n * @property {boolean}   isGroupable       Indicates if the selected blocks can be grouped.\n * @property {boolean}   isUngroupable     Indicates if the selected blocks can be ungrouped.\n * @property {WPBlock[]} blocksSelection   An array of the selected blocks.\n * @property {string}    groupingBlockName The name of block used for handling grouping interactions.\n */\n\n/**\n * Returns the properties `ConvertToGroupButton` component needs to work properly.\n * It is used in `BlockSettingsMenuControls` to know if `ConvertToGroupButton`\n * should be rendered, to avoid ending up with an empty MenuGroup.\n *\n * @param {?string[]} selectedClientIds An optional array of clientIds to group. The selected blocks\n *                                      from the block editor store are used if this is not provided.\n *\n * @return {ConvertToGroupButtonProps} Returns the properties needed by `ConvertToGroupButton`.\n */\nexport default function useConvertToGroupButtonProps( selectedClientIds ) {\n\treturn useSelect(\n\t\t( select ) => {\n\t\t\tconst {\n\t\t\t\tgetBlockRootClientId,\n\t\t\t\tgetBlocksByClientId,\n\t\t\t\tcanInsertBlockType,\n\t\t\t\tgetSelectedBlockClientIds,\n\t\t\t} = select( blockEditorStore );\n\t\t\tconst { getGroupingBlockName, getBlockType } =\n\t\t\t\tselect( blocksStore );\n\t\t\tconst clientIds = selectedClientIds?.length\n\t\t\t\t? selectedClientIds\n\t\t\t\t: getSelectedBlockClientIds();\n\t\t\tconst groupingBlockName = getGroupingBlockName();\n\n\t\t\tconst rootClientId = clientIds?.length\n\t\t\t\t? getBlockRootClientId( clientIds[ 0 ] )\n\t\t\t\t: undefined;\n\n\t\t\tconst groupingBlockAvailable = canInsertBlockType(\n\t\t\t\tgroupingBlockName,\n\t\t\t\trootClientId\n\t\t\t);\n\n\t\t\tconst blocksSelection = getBlocksByClientId( clientIds );\n\t\t\tconst isSingleBlockSelected = blocksSelection.length === 1;\n\t\t\tconst [ firstSelectedBlock ] = blocksSelection;\n\t\t\t// A block is ungroupable if it is a single grouping block with inner blocks.\n\t\t\t// If a block has an `ungroup` transform, it is also ungroupable, without the\n\t\t\t// requirement of being the default grouping block.\n\t\t\t// Do we have a single grouping Block selected and does that group have inner blocks?\n\t\t\tconst isUngroupable =\n\t\t\t\tisSingleBlockSelected &&\n\t\t\t\t( firstSelectedBlock.name === groupingBlockName ||\n\t\t\t\t\tgetBlockType( firstSelectedBlock.name )?.transforms\n\t\t\t\t\t\t?.ungroup ) &&\n\t\t\t\t!! firstSelectedBlock.innerBlocks.length;\n\n\t\t\t// Do we have\n\t\t\t// 1. Grouping block available to be inserted?\n\t\t\t// 2. One or more blocks selected\n\t\t\tconst isGroupable =\n\t\t\t\tgroupingBlockAvailable && blocksSelection.length;\n\n\t\t\treturn {\n\t\t\t\tclientIds,\n\t\t\t\tisGroupable,\n\t\t\t\tisUngroupable,\n\t\t\t\tblocksSelection,\n\t\t\t\tgroupingBlockName,\n\t\t\t\tonUngroup:\n\t\t\t\t\tisUngroupable &&\n\t\t\t\t\tgetBlockType( firstSelectedBlock.name )?.transforms\n\t\t\t\t\t\t?.ungroup,\n\t\t\t};\n\t\t},\n\t\t[ selectedClientIds ]\n\t);\n}\n"]}