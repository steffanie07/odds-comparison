{"version":3,"sources":["@wordpress/rich-text/src/component/use-select-object.js"],"names":["useRefEffect","useSelectObject","element","onClick","event","target","textContent","isContentEditable","ownerDocument","defaultView","selection","getSelection","containsNode","range","createRange","nodeToSelect","closest","selectNode","removeAllRanges","addRange","preventDefault","onFocusIn","relatedTarget","contains","tagName","addEventListener","removeEventListener"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,YAAT,QAA6B,oBAA7B;AAEA,OAAO,SAASC,eAAT,GAA2B;AACjC,SAAOD,YAAY,CAAIE,OAAF,IAAe;AACnC,aAASC,OAAT,CAAkBC,KAAlB,EAA0B;AACzB,YAAM;AAAEC,QAAAA;AAAF,UAAaD,KAAnB,CADyB,CAGzB;;AACA,UACCC,MAAM,KAAKH,OAAX,IACEG,MAAM,CAACC,WAAP,IAAsBD,MAAM,CAACE,iBAFhC,EAGE;AACD;AACA;;AAED,YAAM;AAAEC,QAAAA;AAAF,UAAoBH,MAA1B;AACA,YAAM;AAAEI,QAAAA;AAAF,UAAkBD,aAAxB;AACA,YAAME,SAAS,GAAGD,WAAW,CAACE,YAAZ,EAAlB,CAbyB,CAezB;AACA;;AACA,UAAKD,SAAS,CAACE,YAAV,CAAwBP,MAAxB,CAAL,EAAwC;AAExC,YAAMQ,KAAK,GAAGL,aAAa,CAACM,WAAd,EAAd,CAnByB,CAoBzB;AACA;;AACA,YAAMC,YAAY,GAAGV,MAAM,CAACE,iBAAP,GAClBF,MADkB,GAElBA,MAAM,CAACW,OAAP,CAAgB,mBAAhB,CAFH;AAIAH,MAAAA,KAAK,CAACI,UAAN,CAAkBF,YAAlB;AACAL,MAAAA,SAAS,CAACQ,eAAV;AACAR,MAAAA,SAAS,CAACS,QAAV,CAAoBN,KAApB;AAEAT,MAAAA,KAAK,CAACgB,cAAN;AACA;;AAED,aAASC,SAAT,CAAoBjB,KAApB,EAA4B;AAC3B;AACA,UACCA,KAAK,CAACkB,aAAN,IACA,CAAEpB,OAAO,CAACqB,QAAR,CAAkBnB,KAAK,CAACkB,aAAxB,CADF,IAEAlB,KAAK,CAACkB,aAAN,CAAoBE,OAApB,KAAgC,GAHjC,EAIE;AACDrB,QAAAA,OAAO,CAAEC,KAAF,CAAP;AACA;AACD;;AAEDF,IAAAA,OAAO,CAACuB,gBAAR,CAA0B,OAA1B,EAAmCtB,OAAnC;AACAD,IAAAA,OAAO,CAACuB,gBAAR,CAA0B,SAA1B,EAAqCJ,SAArC;AACA,WAAO,MAAM;AACZnB,MAAAA,OAAO,CAACwB,mBAAR,CAA6B,OAA7B,EAAsCvB,OAAtC;AACAD,MAAAA,OAAO,CAACwB,mBAAR,CAA6B,SAA7B,EAAwCL,SAAxC;AACA,KAHD;AAIA,GAnDkB,EAmDhB,EAnDgB,CAAnB;AAoDA","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useRefEffect } from '@wordpress/compose';\n\nexport function useSelectObject() {\n\treturn useRefEffect( ( element ) => {\n\t\tfunction onClick( event ) {\n\t\t\tconst { target } = event;\n\n\t\t\t// If the child element has no text content, it must be an object.\n\t\t\tif (\n\t\t\t\ttarget === element ||\n\t\t\t\t( target.textContent && target.isContentEditable )\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { ownerDocument } = target;\n\t\t\tconst { defaultView } = ownerDocument;\n\t\t\tconst selection = defaultView.getSelection();\n\n\t\t\t// If it's already selected, do nothing and let default behavior\n\t\t\t// happen. This means it's \"click-through\".\n\t\t\tif ( selection.containsNode( target ) ) return;\n\n\t\t\tconst range = ownerDocument.createRange();\n\t\t\t// If the target is within a non editable element, select the non\n\t\t\t// editable element.\n\t\t\tconst nodeToSelect = target.isContentEditable\n\t\t\t\t? target\n\t\t\t\t: target.closest( '[contenteditable]' );\n\n\t\t\trange.selectNode( nodeToSelect );\n\t\t\tselection.removeAllRanges();\n\t\t\tselection.addRange( range );\n\n\t\t\tevent.preventDefault();\n\t\t}\n\n\t\tfunction onFocusIn( event ) {\n\t\t\t// When there is incoming focus from a link, select the object.\n\t\t\tif (\n\t\t\t\tevent.relatedTarget &&\n\t\t\t\t! element.contains( event.relatedTarget ) &&\n\t\t\t\tevent.relatedTarget.tagName === 'A'\n\t\t\t) {\n\t\t\t\tonClick( event );\n\t\t\t}\n\t\t}\n\n\t\telement.addEventListener( 'click', onClick );\n\t\telement.addEventListener( 'focusin', onFocusIn );\n\t\treturn () => {\n\t\t\telement.removeEventListener( 'click', onClick );\n\t\t\telement.removeEventListener( 'focusin', onFocusIn );\n\t\t};\n\t}, [] );\n}\n"]}